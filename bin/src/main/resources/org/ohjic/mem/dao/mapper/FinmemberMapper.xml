<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.ohjic.mem.dao.FinmemberMapper">
  <resultMap id="BaseResultMap" type="org.ohjic.mem.model.Finmember">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 04 14:28:19 KST 2017.
    -->
    <id column="pid" jdbcType="INTEGER" property="pid" />
    <id column="mem_type" jdbcType="INTEGER" property="memType" />
    <result column="envNo" jdbcType="VARCHAR" property="envNo" />
    <result column="tid" jdbcType="INTEGER" property="tid" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="partner_name" jdbcType="VARCHAR" property="partnerName" />
    <result column="group_name" jdbcType="VARCHAR" property="groupName" />
    <result column="addr" jdbcType="VARCHAR" property="addr" />
    <result column="phone" jdbcType="VARCHAR" property="phone" />
    <result column="birth_year" jdbcType="SMALLINT" property="birthYear" />
    <result column="birth_date" jdbcType="SMALLINT" property="birthDate" />
    <result column="permitNo" jdbcType="VARCHAR" property="permitNo" />
    <result column="leaderName" jdbcType="VARCHAR" property="leaderName" />
    <result column="bankName" jdbcType="VARCHAR" property="bankName" />
    <result column="standardCode" jdbcType="INTEGER" property="standardCode" />
    <result column="accountNo" jdbcType="VARCHAR" property="accountNo" />
    <result column="accountHolder" jdbcType="VARCHAR" property="accountHolder" />
    <result column="prevCode" jdbcType="VARCHAR" property="prevCode" />
    <result column="etc" jdbcType="VARCHAR" property="etc" />
    <result column="merged_pid" jdbcType="INTEGER" property="mergedPid" />
    <result column="merged_tid" jdbcType="INTEGER" property="mergedTid" />
    <result column="vpa_account" jdbcType="VARCHAR" property="vpaAccount" />
    <result column="vpa_trnx_id" jdbcType="VARCHAR" property="vpaTrnxId" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 04 14:28:19 KST 2017.
    -->
    pid, mem_type, envNo, tid, name, partner_name, group_name, addr, phone, birth_year, 
    birth_date, permitNo, leaderName, bankName, standardCode, accountNo, accountHolder, 
    prevCode, etc, merged_pid, merged_tid, vpa_account, vpa_trnx_id
  </sql>
  <select id="selectByPrimaryKey" parameterType="org.ohjic.mem.model.FinmemberKey" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 04 14:28:19 KST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from finMember
    where pid = #{pid,jdbcType=INTEGER}
      and mem_type = #{memType,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="org.ohjic.mem.model.FinmemberKey">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 04 14:28:19 KST 2017.
    -->
    delete from finMember
    where pid = #{pid,jdbcType=INTEGER}
      and mem_type = #{memType,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="org.ohjic.mem.model.Finmember">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 04 14:28:19 KST 2017.
    -->
    insert into finMember (pid, mem_type, envNo, 
      tid, name, partner_name, 
      group_name, addr, phone, 
      birth_year, birth_date, permitNo, 
      leaderName, bankName, standardCode, 
      accountNo, accountHolder, prevCode, 
      etc, merged_pid, merged_tid, 
      vpa_account, vpa_trnx_id)
    values (#{pid,jdbcType=INTEGER}, #{memType,jdbcType=INTEGER}, #{envNo,jdbcType=VARCHAR}, 
      #{tid,jdbcType=INTEGER}, #{name,jdbcType=VARCHAR}, #{partnerName,jdbcType=VARCHAR}, 
      #{groupName,jdbcType=VARCHAR}, #{addr,jdbcType=VARCHAR}, #{phone,jdbcType=VARCHAR}, 
      #{birthYear,jdbcType=SMALLINT}, #{birthDate,jdbcType=SMALLINT}, #{permitNo,jdbcType=VARCHAR}, 
      #{leaderName,jdbcType=VARCHAR}, #{bankName,jdbcType=VARCHAR}, #{standardCode,jdbcType=INTEGER}, 
      #{accountNo,jdbcType=VARCHAR}, #{accountHolder,jdbcType=VARCHAR}, #{prevCode,jdbcType=VARCHAR}, 
      #{etc,jdbcType=VARCHAR}, #{mergedPid,jdbcType=INTEGER}, #{mergedTid,jdbcType=INTEGER}, 
      #{vpaAccount,jdbcType=VARCHAR}, #{vpaTrnxId,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="org.ohjic.mem.model.Finmember">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 04 14:28:19 KST 2017.
    -->
    insert into finMember
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="pid != null">
        pid,
      </if>
      <if test="memType != null">
        mem_type,
      </if>
      <if test="envNo != null">
        envNo,
      </if>
      <if test="tid != null">
        tid,
      </if>
      <if test="name != null">
        name,
      </if>
      <if test="partnerName != null">
        partner_name,
      </if>
      <if test="groupName != null">
        group_name,
      </if>
      <if test="addr != null">
        addr,
      </if>
      <if test="phone != null">
        phone,
      </if>
      <if test="birthYear != null">
        birth_year,
      </if>
      <if test="birthDate != null">
        birth_date,
      </if>
      <if test="permitNo != null">
        permitNo,
      </if>
      <if test="leaderName != null">
        leaderName,
      </if>
      <if test="bankName != null">
        bankName,
      </if>
      <if test="standardCode != null">
        standardCode,
      </if>
      <if test="accountNo != null">
        accountNo,
      </if>
      <if test="accountHolder != null">
        accountHolder,
      </if>
      <if test="prevCode != null">
        prevCode,
      </if>
      <if test="etc != null">
        etc,
      </if>
      <if test="mergedPid != null">
        merged_pid,
      </if>
      <if test="mergedTid != null">
        merged_tid,
      </if>
      <if test="vpaAccount != null">
        vpa_account,
      </if>
      <if test="vpaTrnxId != null">
        vpa_trnx_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="pid != null">
        #{pid,jdbcType=INTEGER},
      </if>
      <if test="memType != null">
        #{memType,jdbcType=INTEGER},
      </if>
      <if test="envNo != null">
        #{envNo,jdbcType=VARCHAR},
      </if>
      <if test="tid != null">
        #{tid,jdbcType=INTEGER},
      </if>
      <if test="name != null">
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="partnerName != null">
        #{partnerName,jdbcType=VARCHAR},
      </if>
      <if test="groupName != null">
        #{groupName,jdbcType=VARCHAR},
      </if>
      <if test="addr != null">
        #{addr,jdbcType=VARCHAR},
      </if>
      <if test="phone != null">
        #{phone,jdbcType=VARCHAR},
      </if>
      <if test="birthYear != null">
        #{birthYear,jdbcType=SMALLINT},
      </if>
      <if test="birthDate != null">
        #{birthDate,jdbcType=SMALLINT},
      </if>
      <if test="permitNo != null">
        #{permitNo,jdbcType=VARCHAR},
      </if>
      <if test="leaderName != null">
        #{leaderName,jdbcType=VARCHAR},
      </if>
      <if test="bankName != null">
        #{bankName,jdbcType=VARCHAR},
      </if>
      <if test="standardCode != null">
        #{standardCode,jdbcType=INTEGER},
      </if>
      <if test="accountNo != null">
        #{accountNo,jdbcType=VARCHAR},
      </if>
      <if test="accountHolder != null">
        #{accountHolder,jdbcType=VARCHAR},
      </if>
      <if test="prevCode != null">
        #{prevCode,jdbcType=VARCHAR},
      </if>
      <if test="etc != null">
        #{etc,jdbcType=VARCHAR},
      </if>
      <if test="mergedPid != null">
        #{mergedPid,jdbcType=INTEGER},
      </if>
      <if test="mergedTid != null">
        #{mergedTid,jdbcType=INTEGER},
      </if>
      <if test="vpaAccount != null">
        #{vpaAccount,jdbcType=VARCHAR},
      </if>
      <if test="vpaTrnxId != null">
        #{vpaTrnxId,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="org.ohjic.mem.model.Finmember">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 04 14:28:19 KST 2017.
    -->
    update finMember
    <set>
      <if test="envNo != null">
        envNo = #{envNo,jdbcType=VARCHAR},
      </if>
      <if test="tid != null">
        tid = #{tid,jdbcType=INTEGER},
      </if>
      <if test="name != null">
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="partnerName != null">
        partner_name = #{partnerName,jdbcType=VARCHAR},
      </if>
      <if test="groupName != null">
        group_name = #{groupName,jdbcType=VARCHAR},
      </if>
      <if test="addr != null">
        addr = #{addr,jdbcType=VARCHAR},
      </if>
      <if test="phone != null">
        phone = #{phone,jdbcType=VARCHAR},
      </if>
      <if test="birthYear != null">
        birth_year = #{birthYear,jdbcType=SMALLINT},
      </if>
      <if test="birthDate != null">
        birth_date = #{birthDate,jdbcType=SMALLINT},
      </if>
      <if test="permitNo != null">
        permitNo = #{permitNo,jdbcType=VARCHAR},
      </if>
      <if test="leaderName != null">
        leaderName = #{leaderName,jdbcType=VARCHAR},
      </if>
      <if test="bankName != null">
        bankName = #{bankName,jdbcType=VARCHAR},
      </if>
      <if test="standardCode != null">
        standardCode = #{standardCode,jdbcType=INTEGER},
      </if>
      <if test="accountNo != null">
        accountNo = #{accountNo,jdbcType=VARCHAR},
      </if>
      <if test="accountHolder != null">
        accountHolder = #{accountHolder,jdbcType=VARCHAR},
      </if>
      <if test="prevCode != null">
        prevCode = #{prevCode,jdbcType=VARCHAR},
      </if>
      <if test="etc != null">
        etc = #{etc,jdbcType=VARCHAR},
      </if>
      <if test="mergedPid != null">
        merged_pid = #{mergedPid,jdbcType=INTEGER},
      </if>
      <if test="mergedTid != null">
        merged_tid = #{mergedTid,jdbcType=INTEGER},
      </if>
      <if test="vpaAccount != null">
        vpa_account = #{vpaAccount,jdbcType=VARCHAR},
      </if>
      <if test="vpaTrnxId != null">
        vpa_trnx_id = #{vpaTrnxId,jdbcType=VARCHAR},
      </if>
    </set>
    where pid = #{pid,jdbcType=INTEGER}
      and mem_type = #{memType,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="org.ohjic.mem.model.Finmember">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 04 14:28:19 KST 2017.
    -->
    update finMember
    set envNo = #{envNo,jdbcType=VARCHAR},
      tid = #{tid,jdbcType=INTEGER},
      name = #{name,jdbcType=VARCHAR},
      partner_name = #{partnerName,jdbcType=VARCHAR},
      group_name = #{groupName,jdbcType=VARCHAR},
      addr = #{addr,jdbcType=VARCHAR},
      phone = #{phone,jdbcType=VARCHAR},
      birth_year = #{birthYear,jdbcType=SMALLINT},
      birth_date = #{birthDate,jdbcType=SMALLINT},
      permitNo = #{permitNo,jdbcType=VARCHAR},
      leaderName = #{leaderName,jdbcType=VARCHAR},
      bankName = #{bankName,jdbcType=VARCHAR},
      standardCode = #{standardCode,jdbcType=INTEGER},
      accountNo = #{accountNo,jdbcType=VARCHAR},
      accountHolder = #{accountHolder,jdbcType=VARCHAR},
      prevCode = #{prevCode,jdbcType=VARCHAR},
      etc = #{etc,jdbcType=VARCHAR},
      merged_pid = #{mergedPid,jdbcType=INTEGER},
      merged_tid = #{mergedTid,jdbcType=INTEGER},
      vpa_account = #{vpaAccount,jdbcType=VARCHAR},
      vpa_trnx_id = #{vpaTrnxId,jdbcType=VARCHAR}
    where pid = #{pid,jdbcType=INTEGER}
      and mem_type = #{memType,jdbcType=INTEGER}
  </update>
  
  <update id="updatePartnerNameByDeath" parameterType="org.ohjic.mem.model.Kyo">
	update ${church}.finMember a
	inner join (
		select me.tid, partner.tid partner_tid, partner.cDepth1Name, partner.cDepth2Name from ${church}.member partner
		inner join ${church}.member me on partner.tid=me.partner_tid
		where (partner.cDepth1Name like '%소천%' or partner.cDepth2Name like '%소천%' 
				or partner.cDepth1Name like '%별세%' or partner.cDepth2Name like '%별세%'
				or partner.cDepth1Name like '%사망%' or partner.cDepth2Name like '%사망%'
				or partner.cDepth1Name like '%돌아가신 분%' or partner.cDepth2Name like '%돌아가신 분%'		
				)
	) b on a.tid=b.tid
	set a.partner_name=''
	</update>
</mapper>